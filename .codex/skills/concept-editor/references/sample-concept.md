# concept.md（必ず書く：最新版）
#1.概要（Overview）（先頭固定）
- 作るもの（What）：社内備品の貸出・返却を簡単に管理できるWebアプリ
- 解決すること（Why）：備品の所在不明や二重貸出、返却漏れをなくす
- できること（主要機能の要約）：空き備品の確認、貸出登録、返却登録、備品登録
- 使いどころ（When/Where）：社内からPC/スマホで備品を借りたいとき
- 成果物（Outputs）：貸出中一覧、空き備品一覧、備品台帳
- 前提（Assumptions）：社内利用、SSOでユーザー識別、ネットワーク常時接続

#2.ユーザーの困りごと（Pain）
- 備品の空き状況が分からず、探す時間がかかる
- いつ誰が借りたか把握できず、返却漏れが発生する
- 台帳が更新されず、現物と記録が一致しない

#3.ターゲットと前提環境（詳細）
- ターゲット：社内の一般社員（利用者）、総務/IT（管理者）
- 環境：社内ネットワーク、PC/スマホ対応、ブラウザ利用

#4.採用する技術スタック（採用理由つき）
- フロント：React + TypeScript（保守性と開発生産性が高い）
- バックエンド：Node.js(NestJS)（API設計が整理しやすい）
- DB：PostgreSQL（貸出履歴などのリレーション管理に強い）
- インフラ：Docker + AWS（社内運用と拡張性のバランス）

#5.機能一覧（Features）
| ID | 機能 | 解決するPain | 対応UC |
|---|---|---|---|
| F-1 | 備品一覧/空き状況表示 | 空き不明 | UC-1 |
| F-2 | 貸出登録 | 二重貸出 | UC-1 |
| F-3 | 返却登録 | 返却漏れ | UC-2 |
| F-4 | 備品登録/更新 | 台帳不一致 | UC-3 |

#6.ユースケース（Use Cases）
| ID | 主体 | 目的 | 前提 | 主要手順（最小操作） | 成功条件 | 例外/制約 |
|---|---|---|---|---|---|---|
| UC-1 | 利用者 | 空き備品を貸出する | SSOでログイン済み | 1) 一覧で空きを確認 2) 備品を選択 3) 貸出登録 | 貸出中一覧に反映される | 貸出中の備品は選択不可 |
| UC-2 | 利用者 | 備品を返却する | 貸出中の備品がある | 1) 自分の貸出一覧を開く 2) 返却登録 | 返却済みとして一覧から外れる | 返却済みの二重返却は不可 |
| UC-3 | 管理者 | 備品情報を最新化する | 管理者権限 | 1) 備品一覧を開く 2) 登録/更新 3) 保存 | 備品台帳に反映される | 必須項目が欠けると保存不可 |

#7.Goals（Goalのみ／ユースケース紐づけ必須）
- G-1: 備品の空き状況が即時に分かる（対応：UC-1）
- G-2: 返却漏れが減る（対応：UC-2）
- G-3: 備品台帳が最新化される（対応：UC-3）

#8.基本レイヤー構造（Layering）
| レイヤー | 役割 | 主な処理/データ流れ |
|---|---|---|
| プレゼンテーション層 | 入力/表示 | 備品一覧/貸出/返却/管理画面 |
| アプリ層 | 業務ロジック | 空き判定、貸出登録、返却登録、備品登録 |
| データ層 | 永続化 | 備品・貸出・ユーザー情報の読み書き |

#9.主要データクラス（Key Data Classes / Entities）
| データクラス | 主要属性（不要属性なし） | 用途（対応UC/Feature） |
|---|---|---|
| Equipment | id, name, category, is_active | UC-1/UC-3, F-1/F-4 |
| Loan | id, equipment_id, borrower_id, loaned_at, returned_at | UC-1/UC-2, F-2/F-3 |
| User | id, name, role | UC-1/UC-2/UC-3 |

#10.機能部品の実装順序（Implementation Order）
1. Equipment/Loanのデータモデルと基本API
2. 備品一覧と空き状況表示
3. 貸出登録フロー
4. 返却登録フロー
5. 備品登録/更新（管理者）

#11.用語集（Glossary）
- 備品：社内で共有する物品（PC、プロジェクター等）
- 貸出：備品を一時的に利用者に紐づけること
- 返却：貸出状態を終了し備品を戻すこと
